(this["webpackJsonpfira-web"]=this["webpackJsonpfira-web"]||[]).push([[0],{159:function(e,t,n){e.exports={app:"App_app__16eIj"}},167:function(e,t,n){e.exports={ldsEllipsis:"LoadingIndicator_ldsEllipsis__1NuRE","lds-ellipsis1":"LoadingIndicator_lds-ellipsis1__3Vee3","lds-ellipsis2":"LoadingIndicator_lds-ellipsis2__1xuwq","lds-ellipsis3":"LoadingIndicator_lds-ellipsis3__14o4E"}},168:function(e,t,n){e.exports={menuButton:"Menu_menuButton__2DoUk"}},171:function(e,t,n){e.exports={horizontalLine:"Line_horizontalLine__2MX1a"}},176:function(e,t,n){e.exports=n(321)},184:function(e,t,n){},206:function(e,t){},208:function(e,t){},24:function(e,t,n){e.exports={container:"Admin_container__33nz2",adminArea:"Admin_adminArea__sWTs7",actionBar:"Admin_actionBar__Av4NJ",options:"Admin_options__12fPG",button:"Admin_button__2e16L",statisticsContainer:"Admin_statisticsContainer__2Up_0",statisticValue:"Admin_statisticValue__IzxVH",statisticLabel:"Admin_statisticLabel__3LSN1",statistic:"Admin_statistic__1m6bn"}},245:function(e,t){},246:function(e,t){},321:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(65),i=n.n(o),c=n(12),u=(n(184),n(36)),s=n(47),l=n(159),d=n.n(l),f=n(1),m=n.n(f),p=n(21),g=n(22),v=n(32),E=n(41),h=n.n(E),_=n(162),b=n.n(_),N=n(163),S=n(164),x=n(173),T=n(70),A=n(165),O=n(174),w=function(e){function t(e,n){var a;return Object(N.a)(this,t),(a=Object(x.a)(this,Object(T.a)(t).call(this))).errorText=void 0,a.status=void 0,a.errorText=e,a.status=n,a.message=e,a}return Object(A.a)(t,e),Object(S.a)(t,[{key:"getResponse",value:function(){return this.errorText}},{key:"getStatus",value:function(){return this.status}},{key:"toString",value:function(){return"HttpException: status=".concat(this.status,", errorText='").concat(this.errorText,"'")}}]),t}(Object(O.a)(Error)),y=function(e){var t=function(t){return function(n){for(var a=arguments.length,r=new Array(a>1?a-1:0),o=1;o<a;o++)r[o-1]=arguments[o];return t.apply(void 0,["[".concat(e,"] ").concat(n)].concat(r))}};return{debug:t(console.debug),info:t(console.info),error:t(console.error),dir:t(console.dir),group:console.group,groupEnd:console.groupEnd}},j=b.a.create({baseURL:window.location.origin,timeout:5e3}),R=y("http.client"),I=function(e){var t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return R.info("executing login...",{username:e.username}),n.prev=1,n.next=4,m.a.awrap(j.post("auth/v1/login",e));case 4:return n.abrupt("return",n.sent.data);case 7:if(n.prev=7,n.t0=n.catch(1),R.error("login failed!",n.t0),401!==(null===(t=n.t0.response)||void 0===t?void 0:t.status)){n.next=12;break}throw new w("credentials invalid",401);case 12:throw n.t0;case 13:case"end":return n.stop()}}),null,null,[[1,7]])},P=function(e){var t,n,a;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:R.info("executing refresh...",{refreshRequest:e}),t=1;case 2:if(!(t<=5)){r.next=21;break}return r.prev=3,r.next=6,m.a.awrap(j.post("auth/v1/refresh",e));case 6:return r.abrupt("return",r.sent.data);case 9:if(r.prev=9,r.t0=r.catch(3),R.info("refresh failed for attempt=".concat(t),{error:r.t0}),n=r.t0,t++,!(null===(a=r.t0.response)||void 0===a?void 0:a.status)){r.next=16;break}return r.abrupt("break",21);case 16:if(!(t<=5)){r.next=19;break}return r.next=19,m.a.awrap(J(3e3));case 19:r.next=2;break;case 21:throw R.error("refresh failed!",n),n;case 23:case"end":return r.stop()}}),null,null,[[3,9]])},k=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return R.info("executing preload judgements..."),t.prev=1,t.next=4,m.a.awrap(j.post("judgements/v1/preload",null,{headers:{authorization:"Bearer ".concat(e)}}));case 4:return t.abrupt("return",t.sent.data);case 7:throw t.prev=7,t.t0=t.catch(1),R.error("preload judgements failed!",t.t0),t.t0;case 11:case"end":return t.stop()}}),null,null,[[1,7]])},C=function(e,t,n){return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return R.info("executing submit judgement...",{submitJudgementRequest:n}),a.prev=1,a.next=4,m.a.awrap(j.put("judgements/v1/".concat(t),n,{headers:{authorization:"Bearer ".concat(e)}}));case 4:return a.abrupt("return",a.sent.data);case 7:throw a.prev=7,a.t0=a.catch(1),R.error("submit judgement failed!",a.t0),a.t0;case 11:case"end":return a.stop()}}),null,null,[[1,7]])},L=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return R.info("executing export of judgements..."),t.prev=1,t.next=4,m.a.awrap(j.get("admin/v1/judgements/export/tsv",{headers:{authorization:"Bearer ".concat(e)}}));case 4:return t.abrupt("return",t.sent.data);case 7:throw t.prev=7,t.t0=t.catch(1),R.error("export of judgements failed!",t.t0),t.t0;case 11:case"end":return t.stop()}}),null,null,[[1,7]])},D=function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return R.info("executing update of config...",{updateConfigRequest:t}),n.prev=1,n.next=4,m.a.awrap(j.put("admin/v1/config",t,{headers:{authorization:"Bearer ".concat(e)}}));case 4:return n.abrupt("return",n.sent.data);case 7:throw n.prev=7,n.t0=n.catch(1),R.error("update of config failed!",n.t0),n.t0;case 11:case"end":return n.stop()}}),null,null,[[1,7]])},F=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return R.info("executing retrieval of statistics..."),t.prev=1,t.next=4,m.a.awrap(j.get("admin/v1/statistics",{headers:{authorization:"Bearer ".concat(e)}}));case 4:return t.abrupt("return",t.sent.data);case 7:throw t.prev=7,t.t0=t.catch(1),R.error("retrieval of statistics failed!",t.t0),t.t0;case 11:case"end":return t.stop()}}),null,null,[[1,7]])};function J(e){return new Promise((function(t){return setTimeout(t,e)}))}var B,G,U=n(172),M=n(10),z=n(56),q=n.n(z),V=y("browser-storage"),W=function(e){V.info("saveUser called",{user:e}),localStorage.setItem("user",JSON.stringify(e))},H=function(){V.info("clearUser called"),localStorage.removeItem("user")},K=function(){V.info("getUser called");var e=localStorage.getItem("user");return e?(V.info("user found",{currentlyStoredUser:e}),JSON.parse(e)):(V.info("no user found"),null)},X=y("user.subscriptions"),Y=n(39);!function(e){e.PLAIN_RELEVANCE_SCORING="PLAIN_RELEVANCE_SCORING",e.SCORING_AND_SELECT_SPANS="SCORING_AND_SELECT_SPANS"}(B||(B={})),function(e){e.NOT_RELEVANT="0_NOT_RELEVANT",e.TOPIC_RELEVANT_DOES_NOT_ANSWER="1_TOPIC_RELEVANT_DOES_NOT_ANSWER",e.GOOD_ANSWER="2_GOOD_ANSWER",e.PERFECT_ANSWER="3_PERFECT_ANSWER",e.MISLEADING_ANSWER="-1_MISLEADING_ANSWER"}(G||(G={}));var Z,$=[{text:"Misleading Answer",relevanceLevel:G.MISLEADING_ANSWER,annotationRequired:!1,buttonColor:"#FF7E61"},{text:"Not Relevant",relevanceLevel:G.NOT_RELEVANT,annotationRequired:!1,buttonColor:"#EBB25B"},{text:"Topic Relevant, But Does Not Answer",relevanceLevel:G.TOPIC_RELEVANT_DOES_NOT_ANSWER,annotationRequired:!0,buttonColor:"#FFF498"},{text:"Good Answer",relevanceLevel:G.GOOD_ANSWER,annotationRequired:!0,buttonColor:"#A1E880"},{text:"Perfect Answer",relevanceLevel:G.PERFECT_ANSWER,annotationRequired:!0,buttonColor:"#73FFC3"}],Q=n(94);!function(e){e.ANNOTATOR="ANNOTATOR",e.ADMIN="ADMIN"}(Z||(Z={}));var ee,te=Object(M.b)("AUTHENTICATED"),ne=Object(M.b)("ACKNOWLEDGED_INFO_SCREEN"),ae=Object(M.b)("LOGGED_OUT"),re=Object(M.c)(null,(function(e){return e.addCase(te,(function(e,t){var n,a,r,o,i=Q.decode(t.payload.accessToken),c=Q.decode(t.payload.refreshToken),u=!!(null===(n=i.resource_access)||void 0===n?void 0:null===(a=n["realm-management"])||void 0===a?void 0:null===(r=a.roles)||void 0===r?void 0:r.some((function(e){return"manage-users"===e}))),s=null!==(o=null===e||void 0===e?void 0:e.acknowledgedInfoScreen)&&void 0!==o&&o;return Object(Y.a)({},e,{accessToken:{val:t.payload.accessToken,expiry:i.exp},refreshToken:{val:t.payload.refreshToken,expiry:c.exp},acknowledgedInfoScreen:s,role:u?Z.ADMIN:Z.ANNOTATOR})})).addCase(ne,(function(e,t){e.acknowledgedInfoScreen=t.payload.acknowledgedInfoScreen})).addCase(ae,(function(){return null}))})),oe={authenticate:te,acknowledgeInfoScreen:ne,logout:ae},ie=re;!function(e){e.TO_JUDGE="TO_JUDGE",e.SEND_PENDING="SEND_PENDING",e.SEND_SUCCESS="SEND_SUCCESS",e.SEND_FAILED="SEND_FAILED"}(ee||(ee={}));var ce={judgementPairs:[]},ue=Object(M.b)("JUDGEMENTS_PRELOADED"),se=Object(M.b)("JUDGEMENT_PAIR_RATED"),le=Object(M.b)("RANGE_STARTOREND_SELECTED"),de=Object(M.b)("RANGE_DELETED"),fe=Object(M.b)("JUDGEMENT_STATUS_SET"),me=Object(M.b)("JUDGEMENT_PAIR_SELECTED"),pe=Object(M.c)(ce,(function(e){return e.addCase(ue,(function(e,t){e.alreadyFinished=t.payload.alreadyFinished,e.remainingToFinish=t.payload.remainingToFinish;var n=t.payload.judgements;e.judgementPairs=n.map((function(t){var n,a,r=e.judgementPairs.find((function(e){return e.id===t.id}));return r&&(a=t,(n=r).queryText===a.queryText&&n.docAnnotationParts.length===a.docAnnotationParts.length&&!n.docAnnotationParts.some((function(e,t){return a.docAnnotationParts[t]!==e})))?Object(Y.a)({},t,{},r):Object(Y.a)({},t,{annotatedRanges:[],status:ee.TO_JUDGE})}))})).addCase(se,(function(e,t){var n=e.judgementPairs.find((function(t){return t.id===e.currentJudgementPairId}));n.relevanceLevel=t.payload.relevanceLevel,$.find((function(e){return e.relevanceLevel===n.relevanceLevel})).annotationRequired||(n.annotatedRanges=[],n.currentAnnotationStart=void 0)})).addCase(le,(function(e,t){var n=e.judgementPairs.find((function(t){return t.id===e.currentJudgementPairId}));if(void 0===n.currentAnnotationStart)n.currentAnnotationStart=t.payload.annotationPartIndex;else{var a=n.currentAnnotationStart,r=t.payload.annotationPartIndex,o=a<r?a:r,i=r>a?r:a;n.annotatedRanges.push({start:o,end:i}),n.currentAnnotationStart=void 0}})).addCase(de,(function(e,t){var n=e.judgementPairs.find((function(t){return t.id===e.currentJudgementPairId}));n.annotatedRanges=n.annotatedRanges.filter((function(e){return!(t.payload.annotationPartIndex>=e.start&&t.payload.annotationPartIndex<=e.end)}))})).addCase(fe,(function(e,t){e.judgementPairs.find((function(e){return e.id===t.payload.id})).status=t.payload.status})).addCase(me,(function(e,t){var n,a;e.currentJudgementPairId!==(null===(n=t.payload)||void 0===n?void 0:n.id)&&(e.currentJudgementPairId=null===(a=t.payload)||void 0===a?void 0:a.id,e.currentJudgementPairSelectedOnMs=(new Date).getTime())})).addCase(oe.logout,(function(){return ce}))}));var ge={preloadJudgements:ue,rateJudgementPair:se,selectRangeStartEnd:le,deleteRange:de,setJudgementStatus:fe,selectJudgementPair:me},ve=pe,Ee=y("judgements.service"),he={preloadJudgements:function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return Ee.info("executing preload judgements..."),t.next=3,m.a.awrap(k(Ae.getState().user.accessToken.val));case 3:e=t.sent,Ee.info("preload judgements succeeded! dispatching preload judgements...",{response:e}),Ae.dispatch(ge.preloadJudgements(e));case 6:case"end":return t.stop()}}))},rateJudgementPair:function(e){var t,n;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(Ee.info("executing rate judgement pair..."),Ae.dispatch(ge.rateJudgementPair({relevanceLevel:e})),t=Ae.getState().annotation,n=t.judgementPairs.find((function(e){return e.id===t.currentJudgementPairId})),$.find((function(e){return e.relevanceLevel===n.relevanceLevel})).annotationRequired&&!(n.annotatedRanges.length>0)){a.next=8;break}return a.next=8,m.a.awrap(he.submitCurrentJudgement());case 8:Ee.info("rate judgement pair succeeded!");case 9:case"end":return a.stop()}}))},submitCurrentJudgement:function(){var e,t,n,a,r,o,i,c,u,s,l,d;return m.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:for(Ee.info("executing submit current judgement..."),e=Ae.getState().annotation,t=e.judgementPairs.find((function(t){return t.id===e.currentJudgementPairId})),n=[],a=!0,r=!1,o=void 0,f.prev=7,i=t.annotatedRanges[Symbol.iterator]();!(a=(c=i.next()).done);a=!0)for(u=c.value,s=u.start;s<=u.end;s++)n.push(s);f.next=15;break;case 11:f.prev=11,f.t0=f.catch(7),r=!0,o=f.t0;case 15:f.prev=15,f.prev=16,a||null==i.return||i.return();case 18:if(f.prev=18,!r){f.next=21;break}throw o;case 21:return f.finish(18);case 22:return f.finish(15);case 23:return l=(new Date).getTime(),d=l-e.currentJudgementPairSelectedOnMs,Ae.dispatch(ge.setJudgementStatus({id:t.id,status:ee.SEND_PENDING})),f.prev=26,f.next=29,m.a.awrap(C(Ae.getState().user.accessToken.val,t.id,{relevanceLevel:t.relevanceLevel,relevancePositions:n,durationUsedToJudgeMs:d}));case 29:f.next=36;break;case 31:throw f.prev=31,f.t1=f.catch(26),Ee.error("submit current judgement failed!",{id:t.id,error:f.t1}),Ae.dispatch(ge.setJudgementStatus({id:t.id,status:ee.SEND_FAILED})),f.t1;case 36:Ae.dispatch(ge.setJudgementStatus({id:t.id,status:ee.SEND_SUCCESS})),Ee.info("submit current judgement succeeded!");case 38:case"end":return f.stop()}}),null,null,[[7,11,15,23],[16,,18,22],[26,31]])}},_e=y("annotation.subscriptions");function be(e,t){var n=t.memoizeOnValue(e);e.subscribe((function(){var a=t.memoizeOnValue(e);n!==a&&(n=a,t.listener(e))}))}var Ne=y("store-logger-middleware"),Se=function(e){return function(t){return function(n){Ne.group(n.type),Ne.info("dispatching",n);var a=t(n);return Ne.info("next state",e.getState()),Ne.groupEnd(),a}}},xe=n(26),Te=Object(xe.combineReducers)({user:ie,annotation:ve}),Ae=Object(M.a)({reducer:Te,middleware:[Se].concat(Object(U.a)(Object(M.d)()))});[function(e){var t,n=q.a.duration(1,"minutes"),a=e.getState().user;e.subscribe((function(){var r=e.getState().user;if(r!==a){if(X.info("user changed",{previousUser:a,userOfStore:r}),!(a=r))return X.info("no user present, clear scheduled refresh and browser storage"),clearTimeout(t),H();W({accessToken:a.accessToken.val,refreshToken:a.refreshToken.val,acknowledgedInfoScreen:a.acknowledgedInfoScreen}),X.info("user saved to browser storage");var o=q.a.unix(a.accessToken.expiry).subtract(n),i=q.a.duration(o.diff(q()())).asMilliseconds(),c=a.refreshToken.val;t=setTimeout((function(){return m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.awrap(we.refresh(c));case 2:case"end":return e.stop()}}))}),i),X.info("refresh got scheduled, scheduled at: ".concat(o.toString()))}}))},function(e){e.subscribe((function(){var t=e.getState().annotation,n=e.getState().user;n&&n.accessToken?n.role===Z.ANNOTATOR?void 0===t.remainingToFinish&&(_e.info("no judgement pairs got loaded from the server yet --\x3e execute preload..."),he.preloadJudgements()):_e.info("no judgement pairs got loaded from the server yet, but user role is not annotator --\x3e skip preload"):_e.info("no judgement pairs got loaded from the server yet, but there is no access token available --\x3e skip preload")})),be(e,{memoizeOnValue:function(e){return e.getState().annotation.judgementPairs},listener:function(e){var t=e.getState().annotation;void 0!==t.remainingToFinish&&t.judgementPairs.filter((function(e){return e.status===ee.TO_JUDGE||e.status===ee.SEND_PENDING})).length<=1&&t.remainingToFinish>t.judgementPairs.length&&(_e.info("count of preloaded judgement pairs does not fulfill threshold and there are remaining judgements to preload on the server --\x3e execute preload..."),he.preloadJudgements())}}),be(e,{memoizeOnValue:function(e){return e.getState().annotation.judgementPairs},listener:function(e){var t=e.getState().annotation.judgementPairs.find((function(e){return e.status===ee.TO_JUDGE}));e.dispatch(ge.selectJudgementPair(t))}})}].forEach((function(e){return e(Ae)}));var Oe=y("auth.service"),we={login:function(e,t){var n;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return Oe.info("executing login...",{username:e}),a.next=3,m.a.awrap(I({username:e,password:t}));case 3:n=a.sent,Oe.info("login succeeded! dispatching authenticate...",{loginResponse:n}),Ae.dispatch(oe.authenticate(n));case 6:case"end":return a.stop()}}))},refresh:function(e){var t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return Oe.info("executing refresh...",{refreshToken:e}),n.prev=1,n.next=4,m.a.awrap(P({refreshToken:e}));case 4:t=n.sent,n.next=12;break;case 7:return n.prev=7,n.t0=n.catch(1),Oe.error("refresh failed! dispatching logout...",n.t0),Ae.dispatch(oe.logout()),n.abrupt("return");case 12:Oe.info("refresh succeeded! dispatching authenticate...",{refreshResponse:t}),Ae.dispatch(oe.authenticate(t));case 14:case"end":return n.stop()}}),null,null,[[1,7]])}},ye=n(42),je=n.n(ye),Re=function(e){var t=e.children,n=Object(g.a)(e,["children"]);return r.a.createElement("div",Object.assign({},n,{className:"".concat(n.className," ").concat(je.a.floatingLabelInput)}),t)},Ie=function(e){var t=e.children,n=Object(g.a)(e,["children"]);return r.a.createElement("div",Object.assign({},n,{className:"".concat(n.className," ").concat(je.a.floatingLabelInputContainer)}),t)},Pe=function(e){var t=e.active,n=e.children,a=Object(g.a)(e,["active","children"]);return r.a.createElement("label",Object.assign({},a,{className:"".concat(a.className," ").concat(!!t&&je.a.floatingLabelActive," ").concat(je.a.floatingLabel)}),n)},ke=function(e){var t=e.children,n=e.active,a=e.inputRef,o=Object(g.a)(e,["children","active","inputRef"]);return r.a.createElement("input",Object.assign({},o,{ref:a,onBlur:o.onBlur,className:"".concat(o.className," ").concat(!!n&&je.a.floatingInputActive," ").concat(je.a.floatingInput)}),t)},Ce=function(e){var t=e.id,n=e.label,o=e.type,i=e.className,c=e.value,u=Object(g.a)(e,["id","label","type","className","value"]),s=Object(a.useState)(!!c&&c.length>0),l=Object(p.a)(s,2),d=l[0],f=l[1],m=Object(a.useRef)(null);return r.a.createElement(Re,null,r.a.createElement(Ie,{onClick:function(){m.current.focus()},className:i},r.a.createElement(Pe,{htmlFor:t,active:d},n),r.a.createElement(ke,Object.assign({},u,{active:d,id:t,onBlur:function(e){e.target.value&&0!==e.target.value.length||f(!1),u.onBlur&&u.onBlur(e)},onFocus:function(e){f(!0),u.onFocus&&u.onFocus(e)},inputRef:m,type:o}))))},Le=n(167),De=n.n(Le),Fe=function(){return r.a.createElement("div",{className:De.a.ldsEllipsis},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))},Je=n(49),Be=n.n(Je),Ge=r.a.forwardRef((function(e,t){var n=e.children,o=e.buttonStyle,i=void 0===o?"normal":o,c=e.buttonType,u=void 0===c?"normal":c,s=Object(g.a)(e,["children","buttonStyle","buttonType"]),l=Object(a.useState)(!1),d=Object(p.a)(l,2),f=d[0],m=d[1];return r.a.createElement("button",Object.assign({},s,{onClick:function(e){"function"===typeof s.onClick&&s.onClick(e),m(!0)},onTransitionEnd:function(e){"function"===typeof s.onTransitionEnd&&s.onTransitionEnd(e),m(!1)},ref:t,className:"".concat(s.className," ").concat(Be.a.button," ").concat(f&&Be.a.animate," ").concat("normal"===i?Be.a.styleNormal:Be.a.styleBold," ").concat("primary"===u&&Be.a.typePrimary)}),n)})),Ue=function(e){var t=e.label,n=Object(g.a)(e,["label"]),a=Object(v.d)(n),o=Object(p.a)(a,2),i=o[0],c=o[1],u=c.touched&&c.error;return r.a.createElement("div",null,r.a.createElement(Ce,Object.assign({className:"".concat(h.a.inputField," ").concat(u&&h.a.inputFieldError),htmlFor:n.id||n.name,label:t},i,n)))},Me=function(){return!!Object(c.c)((function(e){return e.user}))?r.a.createElement(u.a,{to:"/"}):r.a.createElement("div",{className:h.a.container},r.a.createElement("h1",{className:h.a.headline},"Fira"),r.a.createElement("div",{className:h.a.inputArea},r.a.createElement("span",{className:h.a.inputHeadline},"Login"),r.a.createElement(v.c,{initialValues:{username:"",password:"",loginError:""},validate:function(e){var t={};return e.username||(t.username="Required"),e.password||(t.password="Required"),t},onSubmit:function(e,t){var n,a;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.setSubmitting,a=t.setErrors,r.prev=1,r.next=4,m.a.awrap(we.login(e.username,e.password));case 4:r.next=10;break;case 6:r.prev=6,r.t0=r.catch(1),"function"===typeof r.t0.getStatus&&401===r.t0.getStatus()?a({loginError:"Credentials invalid."}):"string"===typeof r.t0.message&&/Network Error/i.test(r.t0.message)||"ECONNABORTED"===r.t0.code?a({loginError:"Network error. Please make sure to be online."}):a({loginError:"Unexpected error occured during login."}),n(!1);case 10:case"end":return r.stop()}}),null,null,[[1,6]])}},(function(e){var t=e.isSubmitting;e.errors;return r.a.createElement(v.b,null,r.a.createElement(Ue,{type:"text",label:"Username",name:"username",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),r.a.createElement(Ue,{type:"password",label:"Password",name:"password",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),r.a.createElement(Ge,{buttonStyle:"bold",buttonType:"primary",type:"submit",disabled:t},t?r.a.createElement(Fe,null):r.a.createElement("span",null,"Submit")))}))))},ze=n(24),qe=n.n(ze),Ve=y("admin.service"),We={exportJudgements:function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return Ve.info("executing export of judgements..."),t.next=3,m.a.awrap(L(Ae.getState().user.accessToken.val));case 3:He("judgements.tsv",e=t.sent),Ve.info("export of judgements succeeded!",{response:e});case 6:case"end":return t.stop()}}))},updateConfig:function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return Ve.info("executing update of config..."),t.next=3,m.a.awrap(D(Ae.getState().user.accessToken.val,e));case 3:Ve.info("update of config succeeded!");case 4:case"end":return t.stop()}}))},getStatistics:function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return Ve.info("executing retrieval of statistics..."),t.next=3,m.a.awrap(F(Ae.getState().user.accessToken.val));case 3:return e=t.sent,Ve.info("retrieval of statistics succeeded!",{response:e}),t.abrupt("return",e);case 6:case"end":return t.stop()}}))}};function He(e,t){var n=new Blob([t],{type:"text/tsv"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}var Ke=n(71),Xe=n(322),Ye=n(323),Ze=n(168),$e=n.n(Ze);function Qe(e){throw new Error("Should not get here")}var et=function(e){var t=Object(c.b)(),n={},a=function(a){e.hasOwnProperty(a)&&(n[a]=function(){var n;return t((n=e)[a].apply(n,arguments))})};for(var r in e)a(r);return n};function tt(){return{userRole:Object(c.c)((function(e){if(e.user)return e.user.role===Z.ADMIN||e.user.role===Z.ANNOTATOR?e.user.role:void Qe(e.user.role)})),userAcknowledgedInfoScreen:Object(c.c)((function(e){var t;return!!(null===(t=e.user)||void 0===t?void 0:t.acknowledgedInfoScreen)}))}}var nt=r.a.forwardRef((function(e,t){var n=e.onClick;return r.a.createElement(Ge,{ref:t,className:$e.a.menuButton,onClick:n},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.a.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})))})),at=function(){var e,t=Object(a.useState)(!1),n=Object(p.a)(t,2),o=n[0],i=n[1];e=function(){return i(!1)},Object(a.useEffect)((function(){var t=function(){return e()};return document.addEventListener("click",t,{passive:!0}),function(){return document.removeEventListener("click",t)}}));var c=et(oe),s=Object(u.g)();function l(){c.logout()}function d(){s.push(At)}function f(){i((function(e){return!e}))}function m(e){return r.a.createElement(nt,{onClick:f,ref:e})}return o?r.a.createElement(Ke.c,null,r.a.createElement(Xe.a,null,(function(e){return m(e.ref)})),r.a.createElement(Ye.a,{placement:"bottom-start"},(function(e){var t=e.ref,n=e.style,a=e.placement;return r.a.createElement("div",{ref:t,style:n,"data-placement":a},r.a.createElement(Ge,{onClick:d},"Go to Info Screen"),r.a.createElement(Ge,{onClick:l},"Logout"))}))):m()},rt=n(171),ot=n.n(rt),it=function(){return r.a.createElement("div",{className:ot.a.horizontalLine})},ct=function(){var e=Object(a.useState)(void 0),t=Object(p.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o,e.next=3,m.a.awrap(We.getStatistics());case 3:e.t1=e.sent.statistics,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}))}),[o]),r.a.createElement("div",{className:qe.a.container},r.a.createElement("div",{className:qe.a.adminArea},r.a.createElement("div",{className:qe.a.actionBar},r.a.createElement(Ge,{className:qe.a.button,buttonType:"primary",onClick:We.exportJudgements},"Export Judgements"),r.a.createElement(at,null)),r.a.createElement(it,{orientation:"horizontal"}),r.a.createElement(v.c,{initialValues:{judgementMode:B.SCORING_AND_SELECT_SPANS,rotateDocumentText:"true"},onSubmit:function(e,t){var n;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.setSubmitting,a.prev=1,a.next=4,m.a.awrap(We.updateConfig(Object(Y.a)({},e,{rotateDocumentText:"true"===e.rotateDocumentText})));case 4:n(!0),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),n(!1);case 10:case"end":return a.stop()}}),null,null,[[1,7]])}},(function(e){var t=e.isSubmitting;return r.a.createElement(v.b,{className:qe.a.actionBar},r.a.createElement("div",{className:qe.a.options},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"judgementMode"},"Judgement Mode:"),r.a.createElement(v.a,{name:"judgementMode",as:"select"},Object.values(B).map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"rotateDocumentText"},"Rotate Document Text:"),r.a.createElement(v.a,{name:"rotateDocumentText",as:"select"},r.a.createElement("option",{value:"true"},"true"),r.a.createElement("option",{value:"false"},"false")))),r.a.createElement(Ge,{className:qe.a.button,buttonType:"primary",type:"submit",disabled:t},t?r.a.createElement(Fe,null):"Update Config"))})),r.a.createElement(it,{orientation:"horizontal"}),r.a.createElement("div",{className:qe.a.statisticsContainer},n&&n.map((function(e){return r.a.createElement("div",{key:e.id,className:qe.a.statistic},r.a.createElement("div",{className:qe.a.statisticValue},e.value),r.a.createElement("div",{className:qe.a.statisticLabel},e.label))})))))},ut=n(37),st=n.n(ut),lt=function(){},dt=n(98),ft=n.n(dt),mt=function(e){var t=e.rateLevel,n=e.onClick;return r.a.createElement("div",{className:ft.a.container},r.a.createElement(Ge,{style:{background:t.buttonColor},className:ft.a.button,onClick:n},t.text))},pt=n(43),gt=n.n(pt),vt=function(e){var t=e.text,n=e.isRangeStart,a=e.isInSelectedRange,o=e.showTooltip,i=e.annotationIsAllowedOnPart,c=e.annotationIsAllowedInGeneral,u=e.onPartClick,s=e.onTooltipClick,l=t.replace(" ","\xa0"),d=n?gt.a.rangeStart:"",f=i?gt.a.annotationAllowedOnPart:"",m=c?gt.a.annotationAllowedInGeneral:"",p=function(e){return r.a.createElement("span",{ref:e,onClick:u,className:"".concat(gt.a.annotatePart," ").concat(d," ").concat(a?gt.a.isInRange:""," ").concat(f," ").concat(m)},l)};return o?r.a.createElement(Ke.c,null,r.a.createElement(Xe.a,null,(function(e){var t=e.ref;return p(t)})),r.a.createElement(Ye.a,{placement:"top"},(function(e){var t=e.ref,n=e.style,a=e.placement;return r.a.createElement("div",{ref:t,style:n,"data-placement":a},r.a.createElement(Ge,{buttonType:"primary",className:gt.a.annotatePartTooltipButton,onClick:s},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"18",viewBox:"5 3 14 18",fill:"white"},r.a.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})),"Remove"))}))):p()},Et=function(e){var t,n=e.currentJudgementPair,o=e.remainingToFinish,i=e.alreadyFinished,c=e.selectRangeStartEnd,u=e.deleteRange,s=Object(a.useState)(void 0),l=Object(p.a)(s,2),d=l[0],f=l[1];function m(e){return function(){return he.rateJudgementPair(e)}}t={Digit1:m(G.MISLEADING_ANSWER),Digit2:m(G.NOT_RELEVANT),Digit3:m(G.TOPIC_RELEVANT_DOES_NOT_ANSWER),Digit4:m(G.GOOD_ANSWER),Digit5:m(G.PERFECT_ANSWER)},Object(a.useEffect)((function(){var e=function(e){var n=e.code;t.hasOwnProperty(n)&&t[n]()};return document.addEventListener("keyup",e,{passive:!0}),function(){return document.removeEventListener("keyup",e)}}));var g=$.find((function(e){return e.relevanceLevel===n.relevanceLevel})),v=i/(o+i)*100,E=!g,h=void 0!==n.currentAnnotationStart,_=n.mode===B.SCORING_AND_SELECT_SPANS,b=_&&!!(null===g||void 0===g?void 0:g.annotationRequired)&&0===n.annotatedRanges.length;function N(){f(void 0)}return r.a.createElement(r.a.Fragment,null,void 0!==v&&r.a.createElement("div",{style:{width:"".concat(v,"%")},className:st.a.progressBar}),r.a.createElement("div",{className:st.a.container,onClickCapture:N},r.a.createElement("div",{className:st.a.actionBar},r.a.createElement("div",{className:st.a.queryText},n.queryText),r.a.createElement(at,null)),r.a.createElement(it,{orientation:"horizontal"}),r.a.createElement("div",{key:n.id,className:st.a.annotationArea},n.docAnnotationParts.map((function(e,t){var a=n.annotatedRanges.some((function(e){return e.start<=t&&e.end>=t})),o=n.mode===B.SCORING_AND_SELECT_SPANS&&" "!==e&&!a;return r.a.createElement(vt,{key:t,text:e,isRangeStart:n.currentAnnotationStart===t,isInSelectedRange:a,showTooltip:d===t,annotationIsAllowedOnPart:o,annotationIsAllowedInGeneral:_,onPartClick:o?function(){return c({annotationPartIndex:t})}:a?function(){return f(t)}:lt,onTooltipClick:function(){u({annotationPartIndex:t}),N()}})}))),r.a.createElement("div",{className:st.a.footer},E?$.map((function(e){return r.a.createElement(mt,{key:e.relevanceLevel,rateLevel:e,onClick:m(e.relevanceLevel)})})):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:st.a.guideText},h?r.a.createElement(r.a.Fragment,null,"Finish your selection"):b?r.a.createElement(r.a.Fragment,null,"Please select the relevant regions of the document."):r.a.createElement(r.a.Fragment,null,"Feel free to add more relevant regions or go to the next judgement pair.")),r.a.createElement(Ge,{buttonType:"primary",style:{width:"60px",height:"50px"},disabled:h||b,onClick:function(){return he.submitCurrentJudgement()}},"Next")))))},ht=function(){var e=function(){var e=Object(c.c)((function(e){return e.annotation.judgementPairs.filter((function(e){return e.status===ee.SEND_SUCCESS}))}));return{remainingToFinish:Object(c.c)((function(t){return void 0===t.annotation.remainingToFinish?void 0:t.annotation.remainingToFinish-e.length})),alreadyFinished:Object(c.c)((function(t){return void 0===t.annotation.alreadyFinished?void 0:t.annotation.alreadyFinished+e.length})),currentJudgementPair:Object(c.c)((function(e){return e.annotation.judgementPairs.find((function(t){return t.id===e.annotation.currentJudgementPairId}))}))}}(),t=e.remainingToFinish,n=e.alreadyFinished,a=e.currentJudgementPair,o=et(ge),i=o.selectRangeStartEnd,u=o.deleteRange;return void 0!==t&&t<=0?r.a.createElement("div",null,"Finished!"):void 0!==t&&a?r.a.createElement(Et,{currentJudgementPair:a,remainingToFinish:t,alreadyFinished:null!==n&&void 0!==n?n:0,selectRangeStartEnd:i,deleteRange:u}):r.a.createElement("div",null,"Loading...")},_t=y("annotators.service"),bt=function(e){_t.info("executing acknowledgement of info screen..."),Ae.dispatch(oe.acknowledgeInfoScreen({acknowledgedInfoScreen:!0})),e(),_t.info("acknowledgement of info screen succeeded!")},Nt=function(){var e=Object(u.g)();return r.a.createElement("div",null,r.a.createElement("span",null,"Info screen placeholder"),r.a.createElement(Ge,{buttonType:"primary",onClick:function(){return bt((function(){return e.push(Tt)}))}},"Annotate"))},St=function(e){var t=e.requiredRole,n=Object(g.a)(e,["requiredRole"]),a=Object(c.c)((function(e){return e.user}));return a&&(null===a||void 0===a?void 0:a.role)===t?r.a.createElement(u.b,n):r.a.createElement(u.a,{to:"/"})},xt=function(){var e=tt().userRole;return e?e===Z.ADMIN?r.a.createElement(u.a,{to:"/admin"}):e===Z.ANNOTATOR?r.a.createElement(u.a,{to:"/annotator"}):void Qe():r.a.createElement(u.a,{to:"/login"})},Tt="annotate",At="info",Ot=function(){var e=Object(u.h)(),t=tt().userAcknowledgedInfoScreen;return r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"".concat(e.path,"/").concat(Tt)},t?r.a.createElement(ht,null):r.a.createElement(u.a,{to:"".concat(e.path,"/").concat(At)})),r.a.createElement(u.b,{path:"".concat(e.path,"/").concat(At)},r.a.createElement(Nt,null)),r.a.createElement(u.a,{to:"".concat(e.path,"/").concat(Tt)}))},wt=function(){return r.a.createElement("div",{className:d.a.app},r.a.createElement(s.a,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/"},r.a.createElement(xt,null)),r.a.createElement(u.b,{path:"/login"},r.a.createElement(Me,null)),r.a.createElement(St,{path:"/admin",requiredRole:Z.ADMIN},r.a.createElement(ct,null)),r.a.createElement(St,{path:"/annotator",requiredRole:Z.ANNOTATOR},r.a.createElement(Ot,null)),r.a.createElement(u.a,{to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var yt=y("load-stored-user");var jt=[function(){yt.info("load user from browser storage");var e=K();e?(yt.info("stored user found. dispatching authenticate and acknowledge info screen...",{storedUser:e}),Ae.dispatch(oe.authenticate(e)),Ae.dispatch(oe.acknowledgeInfoScreen({acknowledgedInfoScreen:e.acknowledgedInfoScreen}))):yt.info("no stored user found")}];y("boot").info("executing boot scripts..."),jt.forEach((function(e){return e()}));i.a.render(r.a.createElement(c.a,{store:Ae},r.a.createElement(wt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},37:function(e,t,n){e.exports={progressBar:"Annotation_progressBar__3Zl_I",container:"Annotation_container__uXhm7",actionBar:"Annotation_actionBar__1lfnI",queryText:"Annotation_queryText__3rHCG",annotationArea:"Annotation_annotationArea__2Ta-7",footer:"Annotation_footer__NuKUI",guideText:"Annotation_guideText__3U2FU"}},41:function(e,t,n){e.exports={container:"Login_container__24P7j",inputArea:"Login_inputArea__2NGiA",headline:"Login_headline__sd4WU",inputHeadline:"Login_inputHeadline__3T4gw",errorList:"Login_errorList__3F7_7",inputField:"Login_inputField__24c21",inputFieldError:"Login_inputFieldError__1qmtx"}},42:function(e,t,n){e.exports={floatingLabelInput:"FloatingTextInput_floatingLabelInput__1efr1",floatingLabelInputContainer:"FloatingTextInput_floatingLabelInputContainer__2LY7N",floatingLabel:"FloatingTextInput_floatingLabel__p_hYS",floatingLabelActive:"FloatingTextInput_floatingLabelActive__3cGGa",floatingInput:"FloatingTextInput_floatingInput__k7JFP",floatingInputActive:"FloatingTextInput_floatingInputActive__1t44z"}},43:function(e,t,n){e.exports={annotatePart:"AnnotationPart_annotatePart__2KO7z",rangeStart:"AnnotationPart_rangeStart__3I0cO",isInRange:"AnnotationPart_isInRange__3rg58",annotationAllowedOnPart:"AnnotationPart_annotationAllowedOnPart__Io1FP",annotationAllowedInGeneral:"AnnotationPart_annotationAllowedInGeneral__2kMIW",annotatePartTooltipButton:"AnnotationPart_annotatePartTooltipButton__1RKRc"}},49:function(e,t,n){e.exports={button:"Button_button__aUVEj",typePrimary:"Button_typePrimary__3vapG",styleBold:"Button_styleBold__OSRgP",styleNormal:"Button_styleNormal__21gUz",animate:"Button_animate__P4pSL"}},98:function(e,t,n){e.exports={container:"RateButton_container__34zEJ",button:"RateButton_button__31aTD"}}},[[176,1,2]]]);
//# sourceMappingURL=main.639b7d84.chunk.js.map